# Сброс индекса

## Проблема

При удалении `chroma_data` для пересоздания индекса, файл `data/sync_state.json` остается на хосте и система считает, что все страницы уже проиндексированы.

## Решение

Используйте скрипт `reset_index.ps1` для полной очистки:

```powershell
.\reset_index.ps1
```

Скрипт автоматически:
1. Останавливает контейнер
2. Удаляет `chroma_data/` (весь индекс ChromaDB)
3. Удаляет `data/sync_state.json` (состояние синхронизации)
4. Перезапускает контейнер
5. Проверяет статус индексации

## Ручная очистка

Если нужно сделать вручную:

```powershell
# 1. Остановить контейнер
docker-compose down

# 2. Удалить chroma_data
Remove-Item -Recurse -Force chroma_data

# 3. Удалить sync_state.json
Remove-Item data/sync_state.json -Force

# 4. Перезапустить
docker-compose up -d

# 5. Проверить логи
docker-compose logs confluence-rag --follow
```

## Когда использовать

- После изменения структуры индекса
- После обновления модели embeddings
- При ошибках "Nothing found on disk"
- При необходимости полной переиндексации

## Важно

⚠️ **Полная переиндексация занимает ~15-20 минут** в зависимости от количества страниц.

