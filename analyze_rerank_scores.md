# Анализ Rerank Scores

## Собранные данные из логов

### Top Scores (из тестовых запросов):
- 0.001 (минимальный)
- 0.007
- 0.033
- 0.078
- 0.093
- 0.151
- 0.252
- 0.295 (максимальный)

### Статистика:
- **Минимум**: 0.001
- **Максимум**: 0.295
- **Среднее**: ~0.114
- **Медиана**: ~0.085 (между 0.078 и 0.093)

### Распределение:
- **Q1 (25%)**: ~0.02 (между 0.007 и 0.033)
- **Q3 (75%)**: ~0.20 (между 0.151 и 0.252)

## Рекомендации по порогам

### Вариант 1: Консервативный (строгая фильтрация)
```
RERANK_THRESHOLD_TECHNICAL=0.05   # Пропустит топ-30% результатов
RERANK_THRESHOLD_GENERAL=0.02     # Пропустит топ-50% результатов
```
**Плюсы**: Высокая релевантность, меньше шума  
**Минусы**: Может отфильтровать некоторые релевантные результаты

### Вариант 2: Умеренный (рекомендуется)
```
RERANK_THRESHOLD_TECHNICAL=0.01   # Пропустит топ-60% результатов
RERANK_THRESHOLD_GENERAL=0.005    # Пропустит топ-70% результатов
```
**Плюсы**: Баланс между релевантностью и полнотой  
**Минусы**: Может включить немного шума

### Вариант 3: Мягкий (максимальная полнота)
```
RERANK_THRESHOLD_TECHNICAL=0.005  # Пропустит топ-70% результатов
RERANK_THRESHOLD_GENERAL=0.001   # Пропустит топ-90% результатов
```
**Плюсы**: Максимальная полнота результатов  
**Минусы**: Может включить больше шума

## Итоговая рекомендация

**Рекомендуется Вариант 2 (Умеренный)**:
- `RERANK_THRESHOLD_TECHNICAL=0.01`
- `RERANK_THRESHOLD_GENERAL=0.005`

Эти пороги:
- Пропустят релевантные результаты (scores > 0.01)
- Отфильтруют явно нерелевантные (scores < 0.005)
- Оставят баланс для дальнейшей настройки

## Дальнейшие действия

1. Установить пороги в `.env` согласно Варианту 2
2. Протестировать на реальных запросах
3. При необходимости скорректировать на основе результатов

